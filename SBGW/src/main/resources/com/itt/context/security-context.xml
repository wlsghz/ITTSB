<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:c="http://www.springframework.org/schema/c"
	xmlns:p="http://www.springframework.org/schema/p"
	xsi:schemaLocation="http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.2.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
	
	<http pattern="/resources/**" security="none"/>
	
	<authentication-manager id="memberAuthManager">
		<authentication-provider>
			<jdbc-user-service data-source-ref="dataSource"
				users-by-username-query=
					"select mnum as username, mpwd as password,
						enabled
						from memview
						where mnum=?"
				
				authorities-by-username-query=
				"select mnum as username, lvname as authority
				from memview
				where lvname=?"
				/>
		</authentication-provider>
	</authentication-manager>

	<http pattern="/**" use-expressions="true"  
	authentication-manager-ref="memberAuthManager">
	<intercept-url pattern="/favicon.ico" access="permitAll" />
	<intercept-url pattern="/comes/log*" access="permitAll"/>
	<intercept-url pattern="/**" access="hasAuthority('1')"/>
	
	<form-login
	login-page="/comes/loginForm"
	login-processing-url="/comes/login44"
	username-parameter="id"
	password-parameter="pwd"
	authentication-success-handler-ref="logins"
	authentication-failure-handler-ref="loginf"
	default-target-url="/member/list"
	always-use-default-target="true"
	/>
	<logout
	logout-url="/comes/logout"
	invalidate-session="true"
	logout-success-url="/comes/loginForm"
	/>
	</http>
	<beans:bean id="logins"
				class="com.itt.security.LoginSuccessHandler"
				p:alwaysUseDefaultTargetUrl="true"
				p:defaultTargetUrl="/bj1"
				/>
	<beans:bean id="loginf"
				class="com.itt.security.LoginFailHandler"
				p:defaultFailureUrl="/comes/loginForm"
				/>
	
	
		

	

</beans:beans>
